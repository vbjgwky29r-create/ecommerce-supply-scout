#!/usr/bin/env python
"""
æµ‹è¯•é™ˆè‰³çº¢ä¸“ç”¨ç”µå•†çŒæ‰‹ - çººç»‡å“ä¸“å®¶èƒ½åŠ›
"""

import requests
import json
from datetime import datetime

BASE_URL = "http://localhost:5000"  # æœ¬åœ°æµ‹è¯•
# BASE_URL = "https://ecommerce-supply-scout-1.onrender.com"  # äº‘ç«¯æµ‹è¯•

def print_section(title):
    print(f"\n{'='*70}")
    print(f"  {title}")
    print(f"{'='*70}\n")

def test_textile_terminology_recognition():
    """æµ‹è¯•çººç»‡å“æœ¯è¯­è¯†åˆ«"""
    print_section("ğŸ§µ æµ‹è¯• 1: çººç»‡å“æœ¯è¯­è¯†åˆ«")
    
    test_cases = [
        {
            "name": "çº¯æ£‰å››ä»¶å¥—",
            "input": "å¸®æˆ‘åˆ†æä¸€æ¬¾å››ä»¶å¥—ï¼Œæè´¨æ˜¯çº¯æ£‰ï¼Œ60æ”¯ï¼Œ400æ ¹å¯†åº¦ï¼Œæ´»æ€§å°èŠ±",
            "expected_terms": ["çº¯æ£‰", "60æ”¯", "400æ ¹å¯†åº¦", "æ´»æ€§å°èŠ±"]
        },
        {
            "name": "å¤©ä¸é¢æ–™",
            "input": "å¤©ä¸é¢æ–™çš„åºŠå“æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ",
            "expected_terms": ["å¤©ä¸"]
        },
        {
            "name": "æ··çººæè´¨",
            "input": "æ£‰æ¶¤æ··çººå’Œçº¯æ£‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ",
            "expected_terms": ["æ£‰æ¶¤æ··çºº", "çº¯æ£‰"]
        }
    ]
    
    for i, test_case in enumerate(test_cases, 1):
        print(f"\n--- æµ‹è¯•ç”¨ä¾‹ {i}: {test_case['name']} ---")
        print(f"è¾“å…¥: {test_case['input']}")
        print(f"æœŸæœ›è¯†åˆ«æœ¯è¯­: {', '.join(test_case['expected_terms'])}")
        print(f"âœ… æµ‹è¯•å‡†å¤‡å®Œæˆï¼ˆéœ€è¦å®é™…å¯¹è¯éªŒè¯ï¼‰")

def test_textile_term_interpretation():
    """æµ‹è¯•çººç»‡å“æœ¯è¯­è§£è¯»"""
    print_section("ğŸ“– æµ‹è¯• 2: çººç»‡å“æœ¯è¯­è§£è¯»")
    
    test_cases = [
        {
            "term": "60S 200TC",
            "expected_content": ["çº±æ”¯", "å¯†åº¦", "å“è´¨"]
        },
        {
            "term": "å¤©ä¸",
            "expected_content": ["æè´¨", "ç‰¹æ€§", "èˆ’é€‚åº¦", "é€æ°”æ€§"]
        },
        {
            "term": "æ´»æ€§å°èŠ±",
            "expected_content": ["å·¥è‰º", "ç¯ä¿", "è‰²ç‰¢åº¦"]
        }
    ]
    
    for i, test_case in enumerate(test_cases, 1):
        print(f"\n--- æµ‹è¯•ç”¨ä¾‹ {i}: {test_case['term']} ---")
        print(f"æœŸæœ›åˆ†æå†…å®¹: {', '.join(test_case['expected_content'])}")
        print(f"âœ… æµ‹è¯•å‡†å¤‡å®Œæˆï¼ˆéœ€è¦å®é™…å¯¹è¯éªŒè¯ï¼‰")

def test_bedding_four_piece_analysis():
    """æµ‹è¯•å››ä»¶å¥—åˆ†æèƒ½åŠ›"""
    print_section("ğŸ›ï¸ æµ‹è¯• 3: å››ä»¶å¥—åˆ†æèƒ½åŠ›")
    
    test_cases = [
        {
            "name": "æ™®é€šå››ä»¶å¥—åˆ†æ",
            "input": "å¸®æˆ‘åˆ†æè¿™æ¬¾å››ä»¶å¥—ï¼šçº¯æ£‰40S/133*72ï¼Œæ´»æ€§å°èŠ±ï¼Œ1.5ç±³åºŠé€‚ç”¨ï¼Œå››ä»¶å¥—",
            "expected_analysis": ["é¢æ–™æè´¨", "çº±æ”¯å¯†åº¦", "å·¥è‰ºæŠ€æœ¯", "åŒ…è£…è§„æ ¼", "å“è´¨è¯„ä¼°", "ä»·æ ¼åˆ†æ"]
        },
        {
            "name": "é«˜ç«¯å››ä»¶å¥—åˆ†æ",
            "input": "é•¿ç»’æ£‰60S/200*98ï¼Œæ•°ç å°èŠ±ï¼Œå…­ä»¶å¥—ï¼Œ1.8ç±³åºŠé€‚ç”¨",
            "expected_analysis": ["é•¿ç»’æ£‰", "é«˜çº±æ”¯", "é«˜å¯†åº¦", "æ•°ç å°èŠ±", "å“è´¨ç­‰çº§", "å¸‚åœºå®šä½"]
        }
    ]
    
    for i, test_case in enumerate(test_cases, 1):
        print(f"\n--- æµ‹è¯•ç”¨ä¾‹ {i}: {test_case['name']} ---")
        print(f"è¾“å…¥: {test_case['input']}")
        print(f"æœŸæœ›åˆ†æç»´åº¦: {', '.join(test_case['expected_analysis'])}")
        print(f"âœ… æµ‹è¯•å‡†å¤‡å®Œæˆï¼ˆéœ€è¦å®é™…å¯¹è¯éªŒè¯ï¼‰")

def test_market_analysis():
    """æµ‹è¯•å¸‚åœºåˆ†æèƒ½åŠ›"""
    print_section("ğŸ“Š æµ‹è¯• 4: å¸‚åœºåˆ†æèƒ½åŠ›")
    
    test_cases = [
        {
            "query": "å¸®æˆ‘åˆ†æä¸€ä¸‹å››ä»¶å¥—çš„å¸‚åœºè¶‹åŠ¿",
            "expected_content": ["å¸‚åœºå¢é•¿ç‡", "çƒ­é—¨å…³é”®è¯", "ç«äº‰ç¨‹åº¦", "ä»·æ ¼åŒºé—´"]
        },
        {
            "query": "å¤©ä¸åºŠå“çš„å¸‚åœºå‰æ™¯å¦‚ä½•ï¼Ÿ",
            "expected_content": ["å¸‚åœºè¶‹åŠ¿", "æ¶ˆè´¹è€…åå¥½", "ç«äº‰æ ¼å±€", "åˆ©æ¶¦ç©ºé—´"]
        }
    ]
    
    for i, test_case in enumerate(test_cases, 1):
        print(f"\n--- æµ‹è¯•ç”¨ä¾‹ {i} ---")
        print(f"è¾“å…¥: {test_case['query']}")
        print(f"æœŸæœ›åˆ†æå†…å®¹: {', '.join(test_case['expected_content'])}")
        print(f"âœ… æµ‹è¯•å‡†å¤‡å®Œæˆï¼ˆéœ€è¦å®é™…å¯¹è¯éªŒè¯ï¼‰")

def test_supplier_recommendation():
    """æµ‹è¯•ä¾›åº”å•†æ¨è"""
    print_section("ğŸ­ æµ‹è¯• 5: ä¾›åº”å•†æ¨è")
    
    test_cases = [
        {
            "query": "æ¨èä¸€äº›åšçº¯æ£‰å››ä»¶å¥—çš„ä¼˜è´¨ä¾›åº”å•†",
            "expected_content": ["ä¾›åº”å•†åç§°", "ä»·æ ¼", "èµ·è®¢é‡", "è”ç³»æ–¹å¼", "å¹³å°"]
        },
        {
            "query": "æ‰¾å‡ å®¶åšå¤©ä¸åºŠå“çš„1688ä¾›åº”å•†",
            "expected_content": ["1688å¹³å°", "ä¾›åº”å•†ä¿¡æ¯", "äº§å“è¯¦æƒ…", "ä»·æ ¼å¯¹æ¯”"]
        }
    ]
    
    for i, test_case in enumerate(test_cases, 1):
        print(f"\n--- æµ‹è¯•ç”¨ä¾‹ {i} ---")
        print(f"è¾“å…¥: {test_case['query']}")
        print(f"æœŸæœ›è¾“å‡ºå†…å®¹: {', '.join(test_case['expected_content'])}")
        print(f"âœ… æµ‹è¯•å‡†å¤‡å®Œæˆï¼ˆéœ€è¦å®é™…å¯¹è¯éªŒè¯ï¼‰")

def main():
    """ä¸»æµ‹è¯•å‡½æ•°"""
    print_section("ğŸ§ª é™ˆè‰³çº¢ä¸“ç”¨ç”µå•†çŒæ‰‹ - çººç»‡å“ä¸“å®¶èƒ½åŠ›æµ‹è¯•")
    print(f"  æµ‹è¯•æ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print(f"  æµ‹è¯•åœ°å€: {BASE_URL}")

    # è¿è¡Œæ‰€æœ‰æµ‹è¯•
    test_textile_terminology_recognition()
    test_textile_term_interpretation()
    test_bedding_four_piece_analysis()
    test_market_analysis()
    test_supplier_recommendation()

    print_section("ğŸ“‹ æµ‹è¯•è¯´æ˜")
    
    print("""
æœ¬æµ‹è¯•è„šæœ¬å®šä¹‰äº†çººç»‡å“ä¸“å®¶èƒ½åŠ›çš„æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒ…æ‹¬ï¼š

1. **çººç»‡å“æœ¯è¯­è¯†åˆ«**
   - é¢æ–™æè´¨ï¼ˆçº¯æ£‰ã€å¤©ä¸ã€æ¶¤çº¶ç­‰ï¼‰
   - çº±æ”¯å¯†åº¦ï¼ˆ60Sã€400TCç­‰ï¼‰
   - å·¥è‰ºæŠ€æœ¯ï¼ˆæ´»æ€§å°èŠ±ã€æ•°ç å°èŠ±ç­‰ï¼‰

2. **çººç»‡å“æœ¯è¯­è§£è¯»**
   - æœ¯è¯­å«ä¹‰è§£é‡Š
   - ç‰¹æ€§åˆ†æï¼ˆèˆ’é€‚åº¦ã€è€ç”¨æ€§ç­‰ï¼‰
   - åº”ç”¨åœºæ™¯è¯´æ˜
   - å¸‚åœºå®šä½è¯„ä¼°

3. **å››ä»¶å¥—åˆ†æèƒ½åŠ›**
   - é¢æ–™æè´¨è¯†åˆ«
   - çº±æ”¯å¯†åº¦åˆ†æ
   - å·¥è‰ºæŠ€æœ¯è¯„ä¼°
   - å“è´¨ç­‰çº§åˆ¤æ–­
   - å¸‚åœºä»·æ ¼åˆ†æ

4. **å¸‚åœºåˆ†æèƒ½åŠ›**
   - å¸‚åœºè¶‹åŠ¿åˆ†æ
   - ç«äº‰æ ¼å±€è¯„ä¼°
   - çƒ­é—¨å…³é”®è¯è¯†åˆ«

5. **ä¾›åº”å•†æ¨è**
   - ä¼˜è´¨ä¾›åº”å•†ç­›é€‰
   - ä»·æ ¼å¯¹æ¯”åˆ†æ
   - èµ·è®¢é‡ä¿¡æ¯

ğŸ¯ å¦‚ä½•è¿›è¡Œå®é™…æµ‹è¯•ï¼š

æ–¹æ³• 1: æœ¬åœ°æµ‹è¯•
1. å¯åŠ¨æœ¬åœ°æœåŠ¡: python src/web/app.py
2. è®¿é—® http://localhost:5000
3. åœ¨èŠå¤©ç•Œé¢è¾“å…¥ä¸Šè¿°æµ‹è¯•ç”¨ä¾‹çš„"è¾“å…¥"å†…å®¹
4. è§‚å¯Ÿæ™ºèƒ½ä½“çš„å›å¤æ˜¯å¦åŒ…å«"æœŸæœ›åˆ†æå†…å®¹"

æ–¹æ³• 2: äº‘ç«¯æµ‹è¯•
1. ç­‰å¾… Render éƒ¨ç½²å®Œæˆ
2. è®¿é—® https://ecommerce-supply-scout-1.onrender.com/
3. åœ¨èŠå¤©ç•Œé¢è¾“å…¥æµ‹è¯•ç”¨ä¾‹
4. è§‚å¯Ÿæ™ºèƒ½ä½“çš„å›å¤

ğŸ“ éªŒè¯æ ‡å‡†ï¼š

- âœ… æ™ºèƒ½ä½“èƒ½å¤Ÿå‡†ç¡®è¯†åˆ«çººç»‡å“ä¸“ä¸šæœ¯è¯­
- âœ… æ™ºèƒ½ä½“èƒ½å¤Ÿè§£é‡Šæœ¯è¯­çš„å«ä¹‰å’Œç‰¹æ€§
- âœ… æ™ºèƒ½ä½“èƒ½å¤Ÿåˆ†æå››ä»¶å¥—çš„æ ¸å¿ƒè¦ç´ 
- âœ… æ™ºèƒ½ä½“èƒ½å¤Ÿè¯„ä¼°å“è´¨ç­‰çº§å’Œå¸‚åœºå®šä½
- âœ… æ™ºèƒ½ä½“èƒ½å¤Ÿæä¾›å¸‚åœºåˆ†æå’Œä¾›åº”å•†æ¨è
    """)

if __name__ == "__main__":
    main()
